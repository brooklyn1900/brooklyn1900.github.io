---
layout:     post
title:      OCR项目
date:       2019-08-01
author:     蜗牛
catalog:    true
tags:
    - github
---

### 一 简介

ocr v2 训练/预测 源码。包含服务器和发送端。
### 二 运维说明

#### 2.1 资源准备

##### 下载ocr_v2源码

`git clone git@gitlab.baixing.cn:yinjintao/ocr_v2.git`

##### Requirements
* python3
* PyTorch>-0.4.1
* torchvision>=0.2.1
* opencv-python>=3.4.2

```
cd /path/to/ocr_v2/
 
pip install -r CRAFT/requirements.txt
 ```


#### 2.2 启动ocr服务器
* 1.进入目录
	
`cd /path/to/ocr_v2/`
* 2.启动ocr服务
	
`python ocr_server.py`
        
#### 2.3 发送端测试程序
* 1.运行发送端程序

`python sendTest.py`

* 2.HTTP地址

`http://0.0.0.0:3000/{routing地址}`

#### 2.4 接口设计
* Method: GET
* Request Query

```
{
  type: 'ocr',   //识别类型
  image_url: '待识别图片地址',
  image: 'base64图片'      //image_url 和 image 任意传一个即可，优先使用 image
}
```

* Response

```
//正常返回
{
  "labels": {        //required
    "has_text": 0.9917900562286377,
    "has_no_text": 0.008209943771362305
  },
  "content": [       //optional 检测边框位置信息
    [
      8.0, 
      54.66666793823242, 
      88.0, 
      54.66666793823242, 
      88.0, 
      70.66666412353516, 
      8.0, 
      70.66666412353516
    ], 
	...
  ],
  "debugInfo": {   //optional
    "model": "ocr",
    "modelVersion": 1
  }
}

//异常返回
{
  "error_msg": "未知识别类型",
  "error_code": 404
}
```



### 三 代码结构说明
```
.
├── CRAFT
│   ├── test_api.py		//文字检测程序接口
│   └── 略	
├── craft_mlt_25k.pth		//测试模型
├── ocr_server.py		//ocr服务器
├── README.md
├── sendTest.py		//客户端发送程序
└── test.jpg		//待发送测试图片
```

